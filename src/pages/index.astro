---
import BaseLayout from '@/layouts/BaseLayout.astro';
import Navigation from '@/components/Navigation.astro';
import Hero from '@/components/Hero.astro';
import MusicSection from '@/components/MusicSection.astro';
import AboutSection from '@/components/AboutSection.astro';
import EBookSection from '@/components/ui/EBookSection.astro';
import GallerySection from '@/components/GallerySection.astro';
import WorkingOnSection from '@/components/sections/WorkingOnSection.astro';
import ContactSection from '@/components/ContactSection.astro';
import Footer from '@/components/Footer.astro';
import AudioPlayerManager from '@/components/AudioPlayerManager';
import ErrorBoundary from '@/components/ui/ErrorBoundary';
---

<BaseLayout title="John Ciresi - Musician & Artist">
  <Navigation />
  <Hero />
  <MusicSection />
  <AboutSection />
  <EBookSection />
  <GallerySection />
  <WorkingOnSection />
  <ContactSection />
  <Footer />

  <!-- Audio Player Manager - Listens for AlbumCard click events and manages player state -->
  <ErrorBoundary client:load>
    <AudioPlayerManager client:only="react" />
  </ErrorBoundary>

  <!-- Performance Optimization Script -->
  <script>
    // Initialize performance tracking and optimizations
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        const { initPerformanceTracking } = await import('@/utils/performance');
        const { initPerformanceOptimizations } = await import('@/utils/performanceEnhancements');
        
        initPerformanceTracking();
        initPerformanceOptimizations();
          } catch (error) {
            // Use dynamic import to avoid SSR issues
            import('@/utils/logger').then(({ logWarn }) => {
              logWarn('Performance optimizations failed to load', { 
                component: 'Performance',
                action: 'initOptimizations',
                metadata: { error: error instanceof Error ? error.message : String(error) }
              });
            });
          }
    });
  </script>
</BaseLayout>
